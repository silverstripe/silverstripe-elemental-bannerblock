!function(){"use strict";var e={274:function(e,t,n){var a,l=(a=n(521))&&a.__esModule?a:{default:a};window.document.addEventListener("DOMContentLoaded",(()=>{(0,l.default)()}))},521:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(648)),l=o(n(248)),i=o(n(292));function o(e){return e&&e.__esModule?e:{default:e}}t.default=()=>{a.default.component.registerMany({BlockLinkField:l.default,BlockLinkFieldActions:i.default})}},248:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Component=void 0;var a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=f(t);if(n&&n.has(e))return n.get(e);var a={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=l?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n(363)),l=c(n(86)),i=c(n(42)),o=c(n(264)),s=c(n(754)),r=c(n(820)),d=n(595),u=n(648);function c(e){return e&&e.__esModule?e:{default:e}}function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}const p=(0,u.loadComponent)((0,d.createInsertLinkModal)("SilverStripe\\CMS\\Controllers\\CMSPageEditController","editorInternalLink"));class h extends a.Component{constructor(e){super(e),this.handleCloseModal=this.handleCloseModal.bind(this),this.handleClick=this.handleClick.bind(this),this.handleKeyUp=this.handleKeyUp.bind(this),this.handleSubmitModal=this.handleSubmitModal.bind(this),this.state={isDirty:!1,modalOpen:!1,value:{}}}componentDidMount(){this.componentDidUpdate()}componentDidUpdate(){const e=this.props.value,t=e?JSON.parse(e):{},n=this.state.value;["PageID","TargetBlank","Text","Description"].some((e=>t[e]!==n[e]))&&this.setState({value:t})}getClassNames(){const{extraClass:e}=this.props;return(0,r.default)("form-control","d-flex","justify-content-start","p-2","align-items-center",e)}getLinkRelativeUrl(){const e=this.getLinkedPage();if(e){return`/${(e.URLSegment||e).replace(/^\/+/,"")}`}return""}getActions(){return o.default.LINK_ACTIONS.map((e=>e.callback?e:"clear"===e.value?{...e,callback:()=>{this.setState({value:{}});const{onChange:e}=this.props;e&&e(JSON.stringify({}))}}:e))}getLinkedPage(){const{linkedPage:e,data:t}=this.props;return!t||e&&Object.keys(e).length?e:t.linkedPage}registerChange(){this.setState({isDirty:!0})}handleClick(e){"button"!==e.target.type&&this.setState({modalOpen:!0})}handleKeyUp(e){13===e.keyCode&&this.handleClick(e)}handleCloseModal(){this.setState({modalOpen:!1})}handleSubmitModal(e){const{SecurityID:t,action_insert:n,...a}=e;this.setState({value:a});const{onChange:l}=this.props;l&&l(JSON.stringify(a)),this.registerChange(),this.handleCloseModal()}renderActions(){const{BlockLinkFieldActionsComponent:e}=this.props,t={id:"foo",actions:this.getActions()};return e?a.default.createElement("div",{className:"block-link-field__actions"},a.default.createElement(e,t)):null}renderLinkContent(){const{isDirty:e,value:t}=this.state,n=(0,r.default)("align-self-center","block-link-field__content","mr-auto","d-flex","justify-content-start");if(e)return a.default.createElement("span",{className:n},a.default.createElement("span",{className:"block-link-field__content--message-modified"},s.default._t("BlockLinkField.ModifiedMessage","Changes will be visible upon save")));const l=this.getLinkedPage();return t.PageID&&l.URLSegment?a.default.createElement("span",{className:n},t.Text&&a.default.createElement("span",{className:"block-link-field__title"},t.Text),a.default.createElement("span",{className:"block-link-field__link"},this.getLinkRelativeUrl())):a.default.createElement("span",{className:n},a.default.createElement("span",{className:"block-link-field__content--message-add-link"},s.default._t("BlockLinkField.AddLinkMessage","Add link")))}renderModal(){const{title:e,showLinkText:t,InsertModalLinkComponent:n}=this.props,{modalOpen:l,value:i}=this.state;return a.default.createElement(n,{isOpen:l,onInsert:this.handleSubmitModal,onClosed:this.handleCloseModal,title:e,fileAttributes:i,bodyClassName:"modal__dialog",identifier:"Admin.InsertLinkInternalModal",requireLinkText:t})}render(){const{name:e}=this.props,{value:t}=this.state;return a.default.createElement("div",{className:this.getClassNames(),onClick:this.handleClick,onKeyUp:this.handleKeyUp,role:"button",tabIndex:0},a.default.createElement("span",{className:"block-link-field__icon"}),this.renderLinkContent(),this.renderActions(),a.default.createElement("input",{type:"hidden",name:e,value:JSON.stringify(t)}),this.renderModal())}}t.Component=h;const k=l.default.shape({URLSegment:l.default.string});h.propTypes={BlockLinkFieldActionsComponent:l.default.oneOfType([l.default.node,l.default.func]),extraClass:l.default.string,linkedPage:k,showLinkText:l.default.bool,onChange:l.default.func,title:l.default.string,value:l.default.string},h.defaultProps={linkedPage:{},showLinkText:!0,value:"{}",InsertModalLinkComponent:p};var m=(0,u.inject)(["BlockLinkFieldActions"],(e=>({BlockLinkFieldActionsComponent:e})),(()=>"ElementEditor.BlockLinkFieldComponent"))((0,i.default)(h));t.default=m},292:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Component=void 0;var a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var a={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=l?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n(363)),l=r(n(86)),i=r(n(820)),o=n(127),s=n(648);function r(e){return e&&e.__esModule?e:{default:e}}function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}class u extends a.Component{constructor(e){super(e),this.handleChangeValue=this.handleChangeValue.bind(this)}getOptionByValue(e){return this.props.actions.find((t=>t.value===e))}handleChangeValue(e){e.stopPropagation();let t=null;const n=this.getOptionByValue(e.target.value);return void 0===n?null:(t="function"==typeof n.confirm?n.confirm().then((()=>n.callback())).catch((e=>{if("cancelled"!==e)throw e})):n.callback()||Promise.resolve(),t)}render(){const{id:e,actions:t,ActionMenu:n}=this.props,l=t.map((e=>{const t=(0,i.default)("block-link-field__action","dropdown-item",e.className||"");return a.default.createElement(o.DropdownItem,{type:"button",className:t,key:e.value,onClick:this.handleChangeValue,value:e.value},e.label)})).filter((e=>e));return l.length?a.default.createElement("div",{className:"block-link-field-actions fieldholder-small input-group"},a.default.createElement(n,{id:e,className:"block-link-field-actions__menu"},l)):null}}t.Component=u,u.propTypes={id:l.default.string.isRequired,actions:l.default.arrayOf(l.default.shape({value:l.default.string.isRequired,label:l.default.string.isRequired,className:l.default.string,destructive:l.default.bool,callback:l.default.func,canApply:l.default.func,confirm:l.default.func})),ActionMenu:l.default.oneOfType([l.default.node,l.default.func])},u.defaultProps={id:"",actions:[],ActionMenu:null};var c=(0,s.inject)(["ActionMenu"],(e=>({ActionMenu:e})),(()=>"BlockLinkFieldActions"))(u);t.default=c},264:function(e,t,n){var a;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l={LINK_ACTIONS:[{value:"clear",label:((a=n(754))&&a.__esModule?a:{default:a}).default._t("BlockLinkField.ClearLink","Clear link"),className:"",destructive:!0,canApply:()=>!0,callback:null}]};t.default=l},138:function(e,t,n){var a=s(n(311)),l=s(n(363)),i=n(691),o=n(648);function s(e){return e&&e.__esModule?e:{default:e}}a.default.entwine("ss",(e=>{e(".js-injector-boot .form__field-holder .block-link-field[data-useEntwine]").entwine({ReactRoot:null,onmatch(){const e=this.closest(".cms-content").attr("id"),t=e?{context:e}:{},n=(0,o.loadComponent)("BlockLinkField",t),a=this.data("schema"),s={...this.data("state"),...a.data,hideLabels:!0};let r=this.getReactRoot();r||(r=(0,i.createRoot)(this[0]),this.setReactRoot(r)),r.render(l.default.createElement(n,s))},onunmatch(){const e=this.getReactRoot();e&&(e.unmount(),this.setReactRoot(null))}})}))},42:function(e){e.exports=FieldHolder},648:function(e){e.exports=Injector},595:function(e){e.exports=InsertLinkModal},86:function(e){e.exports=PropTypes},363:function(e){e.exports=React},691:function(e){e.exports=ReactDomClient},127:function(e){e.exports=Reactstrap},820:function(e){e.exports=classnames},754:function(e){e.exports=i18n},311:function(e){e.exports=jQuery}},t={};function n(a){var l=t[a];if(void 0!==l)return l.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,n),i.exports}n(138),n(274)}();